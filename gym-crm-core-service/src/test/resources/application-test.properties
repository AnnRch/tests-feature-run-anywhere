# === Datasource Configuration ===
# Cross-platform support:
# - If Testcontainers is enabled (default), it will automatically configure the datasource
# - If Testcontainers is disabled (testcontainers.enabled=false), use docker-compose PostgreSQL
# 
# Fallback configuration for docker-compose (when Testcontainers is disabled):
spring.datasource.url=${TEST_DATASOURCE_URL:jdbc:postgresql://localhost:5439/gymcrm_test}
spring.datasource.username=${TEST_DATASOURCE_USERNAME:postgres}
spring.datasource.password=${TEST_DATASOURCE_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# Testcontainers configuration (enabled by default, works on Mac/Linux/Windows)
# Set to false to use docker-compose containers instead
# On Windows: if Testcontainers doesn't work, set this to false
testcontainers.enabled=true

# === Flyway Configuration ===
spring.flyway.enabled=true
# Point to your main migrations folder
spring.flyway.locations=classpath:db/migration
# Allow Flyway to clean the schema (CRITICAL for component tests)
spring.flyway.clean-disabled=false

# === JPA / Hibernate ===
# Let Flyway handle the schema; Hibernate only validates it
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

eureka.client.enabled=false
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false

spring.activemq.broker-url=vm://localhost?broker.persistent=false
spring.activemq.user=admin
spring.activemq.password=admin

# Ensure the app doesn't try to connect to the real broker on startup
spring.jms.template.default-destination=trainer.workload.queue